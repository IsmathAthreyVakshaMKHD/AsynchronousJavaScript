<!-- <!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
</head>

<body style="margin: 0">
  <form onsubmit="handleFormSubmit(event)">
    <label for="username">Username</label>
    <input type="text" name="username" id="username" />
    <label for="email">Email</label>
    <input type="email" name="email" id="email" />
    <label for="phone">Phone No</label>
    <input type="tel" name="phone" id="phone" />
    <button type="submit">Submit</button>
  </form>
  <ul></ul>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.5.1/axios.min.js"></script>
<script src="Task 28.js"></script>

</html> -->
<!DOCTYPE  html>
<html lang='en'>
    <head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
    <title>Inventory</title>
    </head>
    <body>
        <form onsubmit="handleFormSubmit(event)">
            <label for="itemName">Item Name</label>
            <input type="text" id="itemName" name="itemName">
            <label for="description">Description</label>
            <input type="text" id="description" name="description">
            <label for="price">Price</label>
            <input type="text" id="price" name="price">
            <label for="quantity">Quantity</label>
            <input type="text" id="quantity" name="quantity">
            <button type="submit">Add Item</button>
        </form>
        <ul id="inventoryList"></ul>
        <!-- <script src="axios.js"></script> -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.2/axios.min.js"></script>
        <script>
            const apiBaseUrl = "https://crudcrud.com/api/c7aa685faab94aad95d23c3651c296e6/inventoryList";
            function handleFormSubmit(event) {
                event.preventDefault();
                let itemNameElement = document.getElementById('itemName').value;
                let descriptionElement = document.getElementById('description').value;
                let priceElement = document.getElementById('price').value;
                let quantityElement = parseInt(document.getElementById('quantity').value);
                const inventoryData = {
                    itemName: itemNameElement,
                    description: descriptionElement,
                    price: priceElement,
                    quantity: quantityElement
                };
                axios.post(apiBaseUrl, inventoryData)
                .then(result => {
                    displayData(result.data);
                })
                .catch(error => {
                    console.log(error);
                });
            }

            function displayData(inventoryData) {
                let itemNameElement = inventoryData.itemName;
                let descriptionElement = inventoryData.description;
                let priceElement = inventoryData.price;
                let quantityElement = inventoryData.quantity;
                
                let unorderedListElement = document.getElementById('inventoryList');
                let listElement = document.createElement('li');
                listElement.textContent = `${itemNameElement}, ${descriptionElement}, ${priceElement}, ${quantityElement}`;
                
                let buyOneElement = document.createElement('button');
                buyOneElement.textContent = 'BuyOne';
                buyOneElement.addEventListener('click', () => updateQuantity(inventoryData, 1));

                let buyTwoElement = document.createElement('button');
                buyTwoElement.textContent = 'BuyTwo';
                buyTwoElement.addEventListener('click', () => updateQuantity(inventoryData, 2));

                let buyThreeElement = document.createElement('button');
                buyThreeElement.textContent = 'BuyThree';
                buyThreeElement.addEventListener('click', () => updateQuantity(inventoryData, 3));
                
                listElement.appendChild(buyOneElement);
                listElement.appendChild(buyTwoElement);
                listElement.appendChild(buyThreeElement);
                unorderedListElement.appendChild(listElement);
            }

            function updateQuantity(inventoryData, quantity) {
                const newQuantity = inventoryData.quantity - quantity;
                if (newQuantity < 0) {
                    alert('Not enough quantity available');
                    return;
                }
                
                const updatedData = { ...inventoryData, quantity: newQuantity };

                axios.put(`${apiBaseUrl}/${inventoryData._id}`, updatedData)
                .then(response => {
                    // Update the display
                    loadData();
                })
                .catch(error => {
                    console.log(error);
                });
            }

            function loadData() {
                axios.get(apiBaseUrl)
                .then((response) => {   
                    const unorderedListElement = document.getElementById('inventoryList');
                    unorderedListElement.innerHTML = ''; // Clear the list before reloading
                    response.data.forEach(inventoryData => {
                        displayData(inventoryData);
                    });
                })
                .catch((error) => {
                    console.log(error)
                });
            }

            document.addEventListener('DOMContentLoaded', loadData);
        </script>
    </body>
</html>